<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Регистрация пользователя</title>
    <style>@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap');
        *
        {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: 'Quicksand', sans-serif;
        }
        body 
        {
          display: flex;
          justify-content: center;
          align-items: center;
          min-height: 100vh;
          background: #000;
        }
        section 
        {
          position: absolute;
          width: 100vw;
          height: 100vh;
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 2px;
          flex-wrap: wrap;
          overflow: hidden;
        }
        section::before 
        {
          content: '';
          position: absolute;
          width: 100%;
          height: 100%;
          background: linear-gradient(60deg, black, dodgerblue);
          animation: animate 5s linear infinite;
        }
       
        section span 
        {
          position: relative;
          display: block;
          width: calc(6.25vw - 2px);
          height: calc(6.25vw - 2px);
          background: #181818;
          z-index: 2;
          transition: 1.5s;
        }
        .btn{
          cursor: pointer;
          border: 0;
        }

        .reg__wrapper{
          width: 100%;
          display: flex;
          justify-content: space-between;
        }

        .btn--save{
          background:linear-gradient(#ffffff, #4158D0);
          opacity: 0.7;
          font-size: 17px;
          border: 1px solid #000;
          padding: 6px 15px;
          border-radius: 10px;
          margin-right: 10px;
        }

        .btn--go{
          background:linear-gradient(#ffffff, #4158D0);
          font-size: 17px;
          border: 1px solid #000;
          padding: 6px 15px;
          border-radius: 10px;
        }

        section span:hover 
        {
          background:  white;
          transition: 0s;
        }
        
        section .signin
        {
          position: absolute;
          width: 400px;
          background: white;  
          z-index: 1000;
          display: flex;
          justify-content: center;
          align-items: center;
          padding: 40px;
          border-radius: 10px;
          box-shadow: 0 15px 35px rgba(0,0,0,9);
        }
        section .signin .content 
        {
          position: relative;
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
          gap: 40px;
        }
        section .signin .content h2 
        {
          font-size: 2em;
          text-transform: uppercase;
          background-image: linear-gradient(to right, #4158D0 30%, #000000 46%);
  /* обрезаем фон по тексту */
  -webkit-background-clip: text;
  /* меняет цвет текста заголовка на прозрачный что бы можно было увидеть градиент*/
  -webkit-text-fill-color: transparent;
  background-size: 200% auto;
animation: gradientAnimation 5s infinite;
        }

        @keyframes gradientAnimation {
  0% {
    background-position: 100% 50%;
  }
  50% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 100% 50%;
  }
}


        section .signin .content .form 
        {
          width: 100%;
          display: flex;
          flex-direction: column;
          gap: 25px;
        }
        section .signin .content .form .inputBox
        {
          position: relative;
          width: 100%;
        }
        section .signin .content .form .inputBox input 
        {
          position: relative;
          width: 100%;
          background: white;
          border: 1px solid black;
          outline: none;
          padding: 25px 10px 7.5px;
          border-radius: 4px;
          color: #000000;
          font-weight: 500;
          font-size: 1em;
        }
        section .signin .content .form .inputBox i 
        {
          position: absolute;
          left: 0;
          padding: 15px 10px;
          font-style: normal;
          color: #aaa;
          transition: 0.5s;
          pointer-events: none;
        }
        .signin .content .form .inputBox input:focus ~ i,
        .signin .content .form .inputBox input:valid ~ i
        {
          transform: translateY(-7.5px);
          font-size: 0.8em;
          color: #fff;
        }
        .signin .content .form .links 
        {
          position: relative;
          width: 100%;
          display: flex;
          justify-content: space-between;
        }
        .signin .content .form .links a 
        {
          color: #fff;
          text-decoration: none;
        }
        .signin .content .form .links a:nth-child(2)
        {
          color: #fff;
          font-weight: 600;
        }
        .signin .content .form .inputBox input[type="submit"]
        {
          padding: 10px;
          background: rgb(255, 255, 255);
          border: 2px solid black;
          color: #000;
          font-weight: 600;
          font-size: 1.35em;
          letter-spacing: 0.05em;
          cursor: pointer;
        }
        input[type="submit"]:active
        {
          opacity: 0.6;
        }
        @media (max-width: 900px)
        {
          section span 
          {
            width: calc(10vw - 2px);
            height: calc(10vw - 2px);
          }
        }
        @media (max-width: 600px)
        {
          section span 
          {
            width: calc(20vw - 2px);
            height: calc(20vw - 2px);
          }
        }

        .error{
          width: 100%;
          height: 35px;
          background: white;
          color: red;
          
        }

        .error:hover{
          background-color: white;
        }


        .True{
          background-color: white;
          color: green;
          height: 20px;
          text-align: center;
        }

        

        </style>
</head>
<body>
  <section>
    <div class="signin">
        <div class="content">
         <h2>Sign In</h2>
         <span id="allTrue" class="True"></span>
         <form id="registrationForm" class="form">
            <div class="inputBox">
                <input type="text" id="name" name="name" required>
                <i>Имя</i>
                <span id="nameError" class="error"></span>
            </div>
            <div class="inputBox">
                <input type="text" id="surname" name="surname" required>
                <i>Фамилия</i>
                <span id="surnameError" class="error"></span>
            </div>
            <div class="inputBox">
                <input type="email" id="email" name="email" required>
                <i>Email</i>
                <span id="emailError" class="error"></span>
            </div>
            <div class="inputBox">
                <input type="text" id="phone_number" name="phone_number" required>
                <i>Номер телефона</i>
                <span id="phoneError" class="error"></span>
            </div>
            <div class="inputBox">
                <input type="password" id="password" name="password" required>
                <i>Пароль</i>
                <span id="passwordError" class="error"></span>
            </div>
            <div class="links">
                <a href="#">Forgot Password</a>
                <a href="#">Signup</a>
            </div>
            <div class="inputBox">
                <div class="reg__wrapper">
                    <button type="submit" id="save" class="btn btn--save">Сохранить</button>
                   <a href="/login"><button type="button" id="goToMainPage" class="btn btn--go">Перейти на главную</button></a> 
                </div>
            </div>
        </form>
        </div>
    </div>
</section>
<script>
  document.getElementById("registrationForm").addEventListener("submit", async function(event) {
  event.preventDefault();
  const name = document.getElementById("name").value;
  const surname = document.getElementById("surname").value;
  const email = document.getElementById("email").value;
  const phone_number = document.getElementById("phone_number").value;
  const password = document.getElementById("password").value;

  const nameError = document.getElementById("nameError");
  const surnameError = document.getElementById("surnameError");
  const emailError = document.getElementById("emailError");
  const phoneError = document.getElementById("phoneError");
  const passwordError = document.getElementById("passwordError");
  const allTrue = document.getElementById("allTrue");


  nameError.textContent = "";
  surnameError.textContent = "";
  emailError.textContent = "";
  phoneError.textContent = "";
  passwordError.textContent = "";
  allTrue.textContent = "";

  if (name.length < 3) {
    nameError.textContent = "Name must contain at least 3 characters.";
    return;
  }

  if (surname.length < 3) {
    surnameError.textContent = "Surname must contain at least 3 characters.";
    return;
  }

  if (/\d/.test(name)) {
    nameError.textContent = "Name must not contain numbers.";
    return;
  }

  if (/\d/.test(surname)) {
    surnameError.textContent = "Surname must not contain numbers.";
    return;
  }

  if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
    emailError.textContent = "Invalid email format.";
    return;
  }

  if (!email.includes('@') || (!email.includes('.ru') && !email.includes('.com'))) {
    emailError.textContent = "Email must contain '@' and be in the format '.ru' or '.com'.";
    return;
  }

  if (!phone_number.match(/^\d{10}$/)) {
    phoneError.textContent = "Invalid phone number format. Enter 10 digits without separators.";
    return;
  }

  if (password.length < 8 || !/\w*[a-zA-Z]\w*/.test(password) || (!/\d/.test(password))) {
    passwordError.textContent = "Password must contain at least 8 characters and at least one letter.";
    return;
}

  if (name.length >= 3 && surname.length >= 3 && !/\d/.test(name) && !/\d/.test(surname) && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email) && (email.includes('@') && (email.includes('.ru') || email.includes('.com')) ) && phone_number.match(/^\d{10}$/) && password.length >= 8 && /[a-zA-Z]/.test(password) && /\d/.test(password)) {
  document.getElementById("allTrue").textContent = "УСПЕШНО";
} else {
  // если хотя бы одно из условий не выполняется, выполнить следующий блок кода
  // здесь вы можете установить сообщение об ошибке или выполнить другие действия
  return;
}


  const formData = new FormData(this);
  const jsonData = {};
  formData.forEach((value, key) => {
    jsonData[key] = value;
  });

  try {
    const response = await fetch('/register', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(jsonData)
    });

    const result = await response.json();

    // обработка результата запроса
    if (response.ok) {
      successMessage.style.opacity = 1;
      successMessage.textContent = "УСПЕШНО";
    } else {
      console.error("Error sending data:", result.error);
    }
  } catch (error) {
    console.error("Error executing request:", error);
  }
});
</script>
      
</body>